{
	"name": "DF_Adhoc_OtherFact_Evergreen_copy1",
	"properties": {
		"folder": {
			"name": "Client/Adhoc"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "etalentOtherCoreFactTbl",
						"type": "DatasetReference"
					},
					"name": "OtherCore"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "FilterPotentialLearningInnov"
				},
				{
					"name": "FilterPotentialLearnInnov1P"
				},
				{
					"name": "SelectPotentialLearnInnov1P"
				}
			],
			"scriptLines": [
				"parameters{",
				"     Flow_Client_Id as string,",
				"     Flow_Client_Dt as string,",
				"     T1_Event_Type as string,",
				"     T1_Event_Year as string,",
				"     T1_Event_Qtr as string,",
				"     T2_Event_Type as string,",
				"     T2_Event_Year as string,",
				"     T2_Event_Qtr as string,",
				"     T3_Event_Type as string,",
				"     T3_Event_Year as string,",
				"     T3_Event_Qtr as string,",
				"     T4_Event_Type as string,",
				"     T4_Event_Year as string,",
				"     T4_Event_Qtr as string,",
				"     T5_Event_Type as string,",
				"     T5_Event_Year as string,",
				"     T5_Event_Qtr as string,",
				"     T6_Event_Type as string,",
				"     T6_Event_Year as string,",
				"     T6_Event_Qtr as string,",
				"     T7_Event_Type as string,",
				"     T7_Event_Year as string,",
				"     T7_Event_Qtr as string,",
				"     T8_Event_Type as string,",
				"     T8_Event_Year as string,",
				"     T8_Event_Qtr as string,",
				"     T9_Event_Type as string,",
				"     T9_Event_Year as string,",
				"     T9_Event_Qtr as string,",
				"     T10_Event_Type as string,",
				"     T10_Event_Year as string,",
				"     T10_Event_Qtr as string,",
				"     T11_Event_Type as string,",
				"     T11_Event_Year as string,",
				"     T11_Event_Qtr as string,",
				"     T12_Event_Type as string,",
				"     T12_Event_Year as string,",
				"     T12_Event_Qtr as string,",
				"     T13_Event_Type as string,",
				"     T13_Event_Year as string,",
				"     T13_Event_Qtr as string,",
				"     T14_Event_Type as string,",
				"     T14_Event_Year as string,",
				"     T14_Event_Qtr as string,",
				"     T15_Event_Type as string,",
				"     T15_Event_Year as string,",
				"     T15_Event_Qtr as string,",
				"     T16_Event_Type as string,",
				"     T16_Event_Year as string,",
				"     T16_Event_Qtr as string,",
				"     T17_Event_Type as string,",
				"     T17_Event_Year as string,",
				"     T17_Event_Qtr as string,",
				"     T18_Event_Type as string,",
				"     T18_Event_Year as string,",
				"     T18_Event_Qtr as string,",
				"     T19_Event_Type as string,",
				"     T19_Event_Year as string,",
				"     T19_Event_Qtr as string,",
				"     T20_Event_Type as string,",
				"     T20_Event_Year as string,",
				"     T20_Event_Qtr as string,",
				"     T21_Event_Type as string,",
				"     T21_Event_Year as string,",
				"     T21_Event_Qtr as string,",
				"     T22_Event_Type as string,",
				"     T22_Event_Year as string,",
				"     T22_Event_Qtr as string,",
				"     T23_Event_Type as string,",
				"     T23_Event_Year as string,",
				"     T23_Event_Qtr as string,",
				"     T24_Event_Type as string,",
				"     T24_Event_Year as string,",
				"     T24_Event_Qtr as string,",
				"     T25_Event_Type as string,",
				"     T25_Event_Year as string,",
				"     T25_Event_Qtr as string,",
				"     T26_Event_Type as string,",
				"     T26_Event_Year as string,",
				"     T26_Event_Qtr as string,",
				"     T27_Event_Type as string,",
				"     T27_Event_Year as string,",
				"     T27_Event_Qtr as string,",
				"     T28_Event_Type as string,",
				"     T28_Event_Year as string,",
				"     T28_Event_Qtr as string,",
				"     T29_Event_Type as string,",
				"     T29_Event_Year as string,",
				"     T29_Event_Qtr as string,",
				"     T30_Event_Type as string,",
				"     T30_Event_Year as string,",
				"     T30_Event_Qtr as string,",
				"     T31_Event_Type as string,",
				"     T31_Event_Year as string,",
				"     T31_Event_Qtr as string,",
				"     T32_Event_Type as string,",
				"     T32_Event_Year as string,",
				"     T32_Event_Qtr as string,",
				"     T33_Event_Type as string,",
				"     T33_Event_Year as string,",
				"     T33_Event_Qtr as string,",
				"     T34_Event_Type as string,",
				"     T34_Event_Year as string,",
				"     T34_Event_Qtr as string,",
				"     T35_Event_Type as string,",
				"     T35_Event_Year as string,",
				"     T35_Event_Qtr as string,",
				"     T36_Event_Type as string,",
				"     T36_Event_Year as string,",
				"     T36_Event_Qtr as string,",
				"     T37_Event_Type as string,",
				"     T37_Event_Year as string,",
				"     T37_Event_Qtr as string,",
				"     T38_Event_Type as string,",
				"     T38_Event_Year as string,",
				"     T38_Event_Qtr as string,",
				"     T39_Event_Type as string,",
				"     T39_Event_Year as string,",
				"     T39_Event_Qtr as string,",
				"     T40_Event_Type as string,",
				"     T40_Event_Year as string,",
				"     T40_Event_Qtr as string",
				"}",
				"source(output(",
				"          WorkerId as string,",
				"          T1_Year as integer,",
				"          T1_Qtr as integer,",
				"          EventType as string,",
				"          T1_CharVal1 as string,",
				"          T1_CharVal2 as string,",
				"          T1_NumVal1 as double,",
				"          T1_NumVal2 as double,",
				"          T1_DtVal1 as date,",
				"          T1_DtVal2 as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select WorkerId,EventYear as T1_Year,EventQuarter as T1_Qtr,EventType as EventType,OtherCharVal11 T1_CharVal1,OtherCharVal2 T1_CharVal2,OtherNumVal1 as T1_NumVal1,OtherNumVal2 as T1_NumVal2,OtherDtVal1 as T1_DtVal1,OtherDtVal2 as T1_DtVal2 from [dbo].[OtherCoreFactTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}' and EventType = '{$T1_Event_Type}' and EventYear = '{$T1_Event_Year}' and EventQuarter = '{$T1_Event_Qtr}'\"),",
				"     format: 'query') ~> OtherCore",
				"OtherCore filter(EventType=='G&P - Learning and Innovation') ~> FilterPotentialLearningInnov",
				"FilterPotentialLearningInnov join(OtherCore@EventYear == Max1PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterPotentialLearnInnov1P",
				"FilterPotentialLearnInnov1P select(mapColumn(",
				"          WorkerId,",
				"          {Potential 1P (G&P - Learning and Innovation)} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectPotentialLearnInnov1P"
			]
		}
	}
}