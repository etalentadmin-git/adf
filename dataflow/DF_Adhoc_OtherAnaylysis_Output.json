{
	"name": "DF_Adhoc_OtherAnaylysis_Output",
	"properties": {
		"folder": {
			"name": "Client/Adhoc"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "etalentOtherCoreFactTbl",
						"type": "DatasetReference"
					},
					"name": "AllOtherCore"
				},
				{
					"dataset": {
						"referenceName": "etalentOtherCoreFactTbl",
						"type": "DatasetReference"
					},
					"name": "OtherCoreFullPop"
				},
				{
					"dataset": {
						"referenceName": "etalentTmp_OtherAnalysisTbl",
						"type": "DatasetReference"
					},
					"name": "AllOtherTblAnalysis"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Source_FactTblFldr",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "joinT1"
				},
				{
					"name": "SelectCleanup"
				},
				{
					"name": "join1"
				},
				{
					"name": "DerivedAddTypeId"
				},
				{
					"name": "SelectAnalyisTypeOutput"
				},
				{
					"name": "filterT1"
				},
				{
					"name": "filterT2"
				},
				{
					"name": "filterT3"
				},
				{
					"name": "filterT4"
				},
				{
					"name": "TypeT1"
				},
				{
					"name": "TypeT2"
				},
				{
					"name": "TypeT3"
				},
				{
					"name": "TypeT4"
				},
				{
					"name": "selectT1"
				},
				{
					"name": "filterT5"
				},
				{
					"name": "TypeT5"
				},
				{
					"name": "filterT6"
				},
				{
					"name": "TypeT6"
				},
				{
					"name": "filterT7"
				},
				{
					"name": "TypeT7"
				},
				{
					"name": "filterT8"
				},
				{
					"name": "TypeT8"
				},
				{
					"name": "filterT9"
				},
				{
					"name": "TypeT9"
				},
				{
					"name": "filterT10"
				},
				{
					"name": "TypeT10"
				},
				{
					"name": "filterT11"
				},
				{
					"name": "TypeT11"
				},
				{
					"name": "filterT12"
				},
				{
					"name": "TypeT12"
				},
				{
					"name": "filterT13"
				},
				{
					"name": "TypeT13"
				},
				{
					"name": "filterT14"
				},
				{
					"name": "TypeT14"
				},
				{
					"name": "filterT15"
				},
				{
					"name": "TypeT15"
				},
				{
					"name": "filterT16"
				},
				{
					"name": "TypeT16"
				},
				{
					"name": "filterT17"
				},
				{
					"name": "TypeT17"
				},
				{
					"name": "filterT18"
				},
				{
					"name": "TypeT18"
				},
				{
					"name": "filterT19"
				},
				{
					"name": "TypeT19"
				},
				{
					"name": "filterT20"
				},
				{
					"name": "TypeT20"
				},
				{
					"name": "filterT21"
				},
				{
					"name": "TypeT21"
				},
				{
					"name": "filterT22"
				},
				{
					"name": "TypeT22"
				},
				{
					"name": "filterT23"
				},
				{
					"name": "TypeT23"
				},
				{
					"name": "filterT24"
				},
				{
					"name": "TypeT24"
				},
				{
					"name": "filterT25"
				},
				{
					"name": "TypeT25"
				},
				{
					"name": "filterT26"
				},
				{
					"name": "TypeT26"
				},
				{
					"name": "filterT27"
				},
				{
					"name": "TypeT27"
				},
				{
					"name": "filterT28"
				},
				{
					"name": "TypeT28"
				},
				{
					"name": "filterT29"
				},
				{
					"name": "TypeT29"
				},
				{
					"name": "filterT30"
				},
				{
					"name": "TypeT30"
				},
				{
					"name": "filterT31"
				},
				{
					"name": "TypeT31"
				},
				{
					"name": "filterT32"
				},
				{
					"name": "TypeT32"
				},
				{
					"name": "filterT33"
				},
				{
					"name": "TypeT33"
				},
				{
					"name": "filterT34"
				},
				{
					"name": "TypeT34"
				},
				{
					"name": "filterT35"
				},
				{
					"name": "TypeT35"
				},
				{
					"name": "filterT36"
				},
				{
					"name": "TypeT36"
				},
				{
					"name": "filterT37"
				},
				{
					"name": "TypeT37"
				},
				{
					"name": "filterT38"
				},
				{
					"name": "TypeT38"
				},
				{
					"name": "filterT39"
				},
				{
					"name": "TypeT39"
				},
				{
					"name": "filterT40"
				},
				{
					"name": "TypeT40"
				}
			],
			"scriptLines": [
				"parameters{",
				"     Flow_Client_Id as string,",
				"     Flow_Client_Dt as string",
				"}",
				"source(output(",
				"          WorkerId as string,",
				"          Type as string,",
				"          OtherCharVal1 as string,",
				"          OtherCharVal2 as string,",
				"          OtherNumVal1 as double,",
				"          OtherNumVal2 as double,",
				"          OtherDtVal1 as date,",
				"          OtherDtVal2 as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select WorkerId,concat([EventYear],'-','Q',[EventQuarter],' ',[EventType]) as Type,OtherCharVal11 as OtherCharVal1,OtherCharVal2,OtherNumVal1,OtherNumVal2 ,OtherDtVal1 ,OtherDtVal2 from [dbo].[OtherCoreFactTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}'\"),",
				"     format: 'query') ~> AllOtherCore",
				"source(output(",
				"          WorkerId as string,",
				"          ClientId as string,",
				"          ClientEngagementDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select WorkerId,ClientId,ClientEngagementDt from [dbo].[OtherCoreFactTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}'\"),",
				"     format: 'query') ~> OtherCoreFullPop",
				"source(output(",
				"          Id as integer,",
				"          Type as string,",
				"          Year as integer,",
				"          Quarter as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select * from [dbo].[Tmp_OtherAnalysisTbl]\"),",
				"     format: 'query') ~> AllOtherTblAnalysis",
				"OtherCoreFullPop, AllOtherCore join(OtherCoreFullPop@WorkerId == T1_WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> joinT1",
				"joinT1 select(mapColumn(",
				"          WorkerId = OtherCoreFullPop@WorkerId,",
				"          ClientId,",
				"          ClientEngagementDt,",
				"          T1_EventType,",
				"          T1_CharVal1,",
				"          T1_CharVal2,",
				"          T1_NumVal1,",
				"          T1_NumVal2,",
				"          T1_DtVal1,",
				"          T1_DtVal2",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectCleanup",
				"AllOtherCore, TypeT1 join(Type == Type1,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"AllOtherTblAnalysis derive({Type Id} = concat(concat(concat(concat(concat(toString(Year),'-'),'Q'),toString(Quarter)),' '),Type)) ~> DerivedAddTypeId",
				"DerivedAddTypeId select(mapColumn(",
				"          Id,",
				"          Type = {Type Id}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectAnalyisTypeOutput",
				"SelectAnalyisTypeOutput filter(Id==1) ~> filterT1",
				"SelectAnalyisTypeOutput filter(Id==2) ~> filterT2",
				"SelectAnalyisTypeOutput filter(Id==3) ~> filterT3",
				"SelectAnalyisTypeOutput filter(Id==4) ~> filterT4",
				"filterT1 select(mapColumn(",
				"          Type1 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT1",
				"filterT2 select(mapColumn(",
				"          Type2 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT2",
				"filterT3 select(mapColumn(",
				"          Type3 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT3",
				"filterT4 select(mapColumn(",
				"          Type4 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT4",
				"join1 select(mapColumn(",
				"          WorkerId,",
				"          Type,",
				"          OtherCharVal1,",
				"          OtherCharVal2,",
				"          OtherNumVal1,",
				"          OtherNumVal2,",
				"          OtherDtVal1,",
				"          OtherDtVal2",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectT1",
				"SelectAnalyisTypeOutput filter(Id==5) ~> filterT5",
				"filterT5 select(mapColumn(",
				"          Type5 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT5",
				"SelectAnalyisTypeOutput filter(Id==6) ~> filterT6",
				"filterT6 select(mapColumn(",
				"          Type6 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT6",
				"SelectAnalyisTypeOutput filter(Id==7) ~> filterT7",
				"filterT7 select(mapColumn(",
				"          Type7 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT7",
				"SelectAnalyisTypeOutput filter(Id==8) ~> filterT8",
				"filterT8 select(mapColumn(",
				"          Type8 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT8",
				"SelectAnalyisTypeOutput filter(Id==9) ~> filterT9",
				"filterT9 select(mapColumn(",
				"          Type9 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT9",
				"SelectAnalyisTypeOutput filter(Id==10) ~> filterT10",
				"filterT10 select(mapColumn(",
				"          Type10 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT10",
				"SelectAnalyisTypeOutput filter(Id==11) ~> filterT11",
				"filterT11 select(mapColumn(",
				"          Type11 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT11",
				"SelectAnalyisTypeOutput filter(Id==12) ~> filterT12",
				"filterT12 select(mapColumn(",
				"          Type12 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT12",
				"SelectAnalyisTypeOutput filter(Id==13) ~> filterT13",
				"filterT13 select(mapColumn(",
				"          Type13 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT13",
				"SelectAnalyisTypeOutput filter(Id==14) ~> filterT14",
				"filterT14 select(mapColumn(",
				"          Type14 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT14",
				"SelectAnalyisTypeOutput filter(Id==15) ~> filterT15",
				"filterT15 select(mapColumn(",
				"          Type15 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT15",
				"SelectAnalyisTypeOutput filter(Id==16) ~> filterT16",
				"filterT16 select(mapColumn(",
				"          Type16 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT16",
				"SelectAnalyisTypeOutput filter(Id==17) ~> filterT17",
				"filterT17 select(mapColumn(",
				"          Type17 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT17",
				"SelectAnalyisTypeOutput filter(Id==18) ~> filterT18",
				"filterT18 select(mapColumn(",
				"          Type18 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT18",
				"SelectAnalyisTypeOutput filter(Id==19) ~> filterT19",
				"filterT19 select(mapColumn(",
				"          Type19 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT19",
				"SelectAnalyisTypeOutput filter(Id==20) ~> filterT20",
				"filterT20 select(mapColumn(",
				"          Type20 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT20",
				"SelectAnalyisTypeOutput filter(Id==21) ~> filterT21",
				"filterT21 select(mapColumn(",
				"          Type21 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT21",
				"SelectAnalyisTypeOutput filter(Id==22) ~> filterT22",
				"filterT22 select(mapColumn(",
				"          Type22 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT22",
				"SelectAnalyisTypeOutput filter(Id==23) ~> filterT23",
				"filterT23 select(mapColumn(",
				"          Type23 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT23",
				"SelectAnalyisTypeOutput filter(Id==24) ~> filterT24",
				"filterT24 select(mapColumn(",
				"          Type24 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT24",
				"SelectAnalyisTypeOutput filter(Id==25) ~> filterT25",
				"filterT25 select(mapColumn(",
				"          Type25 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT25",
				"SelectAnalyisTypeOutput filter(Id==26) ~> filterT26",
				"filterT26 select(mapColumn(",
				"          Type26 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT26",
				"SelectAnalyisTypeOutput filter(Id==27) ~> filterT27",
				"filterT27 select(mapColumn(",
				"          Type27 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT27",
				"SelectAnalyisTypeOutput filter(Id==28) ~> filterT28",
				"filterT28 select(mapColumn(",
				"          Type28 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT28",
				"SelectAnalyisTypeOutput filter(Id==29) ~> filterT29",
				"filterT29 select(mapColumn(",
				"          Type29 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT29",
				"SelectAnalyisTypeOutput filter(Id==30) ~> filterT30",
				"filterT30 select(mapColumn(",
				"          Type30 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT30",
				"SelectAnalyisTypeOutput filter(Id==31) ~> filterT31",
				"filterT31 select(mapColumn(",
				"          Type31 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT31",
				"SelectAnalyisTypeOutput filter(Id==32) ~> filterT32",
				"filterT32 select(mapColumn(",
				"          Type32 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT32",
				"SelectAnalyisTypeOutput filter(Id==33) ~> filterT33",
				"filterT33 select(mapColumn(",
				"          Type33 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT33",
				"SelectAnalyisTypeOutput filter(Id==34) ~> filterT34",
				"filterT34 select(mapColumn(",
				"          Type34 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT34",
				"SelectAnalyisTypeOutput filter(Id==35) ~> filterT35",
				"filterT35 select(mapColumn(",
				"          Type35 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT35",
				"SelectAnalyisTypeOutput filter(Id==36) ~> filterT36",
				"filterT36 select(mapColumn(",
				"          Type36 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT36",
				"SelectAnalyisTypeOutput filter(Id==37) ~> filterT37",
				"filterT37 select(mapColumn(",
				"          Type37 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT37",
				"SelectAnalyisTypeOutput filter(Id==38) ~> filterT38",
				"filterT38 select(mapColumn(",
				"          Type38 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT38",
				"SelectAnalyisTypeOutput filter(Id==39) ~> filterT39",
				"filterT39 select(mapColumn(",
				"          Type39 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT39",
				"SelectAnalyisTypeOutput filter(Id==40) ~> filterT40",
				"filterT40 select(mapColumn(",
				"          Type40 = Type",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> TypeT40",
				"SelectCleanup sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          Column_1 as string,",
				"          Column_2 as string,",
				"          Column_3 as string,",
				"          Column_4 as string,",
				"          Column_5 as string,",
				"          Column_6 as string,",
				"          Column_7 as string,",
				"          Column_8 as string,",
				"          Column_9 as string,",
				"          Column_10 as string,",
				"          Column_11 as string,",
				"          Column_12 as string,",
				"          Column_13 as string,",
				"          Column_14 as string,",
				"          Column_15 as string,",
				"          Column_16 as string,",
				"          Column_17 as string,",
				"          Column_18 as string,",
				"          Column_19 as string,",
				"          Column_20 as string,",
				"          Column_21 as string,",
				"          Column_22 as string,",
				"          Column_23 as string,",
				"          Column_24 as string,",
				"          Column_25 as string,",
				"          Column_26 as string,",
				"          Column_27 as string,",
				"          Column_28 as string",
				"     ),",
				"     partitionFileNames:['TestOtherAnalysisOutput.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink1"
			]
		}
	}
}