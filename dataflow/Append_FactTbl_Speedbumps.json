{
	"name": "Append_FactTbl_Speedbumps",
	"properties": {
		"folder": {
			"name": "Client/Database/Load Fact Tables"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Source_FactTbl_Speedbumps_File",
						"type": "DatasetReference"
					},
					"name": "Speedbumps"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "etalentSpeedbumpsFactTbl",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "alterRow1"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "select1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {Client ID} as string,",
				"          {Client Engagement Date} as date,",
				"          {Event Quarter} as integer,",
				"          {Event Year} as short,",
				"          {Core Event Id} as string,",
				"          {Core Event Quarter} as integer,",
				"          {Core Event Date} as date,",
				"          {Worker ID} as string,",
				"          {Speedbump Worker Status} as string,",
				"          {Speedbump Population Ind} as string,",
				"          {Speedbump 1 Name} as string,",
				"          {Speedbump 1 Desc} as string,",
				"          {Speedbump 1 Flag} as string,",
				"          {Speedbump 2 Name} as string,",
				"          {Speedbump 2 Desc} as string,",
				"          {Speedbump 2 Flag} as string,",
				"          {Speedbump 3 Name} as string,",
				"          {Speedbump 3 Desc} as string,",
				"          {Speedbump 3 Flag} as string,",
				"          {Speedbump 4 Name} as string,",
				"          {Speedbump 4 Desc} as string,",
				"          {Speedbump 4 Flag} as string,",
				"          {Speedbump 5 Name} as string,",
				"          {Speedbump 5 Desc} as string,",
				"          {Speedbump 5 Flag} as string,",
				"          {Speedbump 6 Name} as string,",
				"          {Speedbump 6 Desc} as string,",
				"          {Speedbump 6 Flag} as string,",
				"          {Speedbump 7 Name} as string,",
				"          {Speedbump 7 Desc} as string,",
				"          {Speedbump 7 Flag} as string,",
				"          {Speedbump 8 Name} as string,",
				"          {Speedbump 8 Desc} as string,",
				"          {Speedbump 8 Flag} as string,",
				"          {Speedbump 9 Name} as string,",
				"          {Speedbump 9 Desc} as string,",
				"          {Speedbump 9 Flag} as string,",
				"          {Speedbump 10 Name} as string,",
				"          {Speedbump 10 Desc} as string,",
				"          {Speedbump 10 Flag} as string,",
				"          {Speedbump 11 Name} as string,",
				"          {Speedbump 11 Desc} as string,",
				"          {Speedbump 11 Flag} as string,",
				"          {Speedbump 12 Name} as string,",
				"          {Speedbump 12 Desc} as string,",
				"          {Speedbump 12 Flag} as string,",
				"          {Speedbump 13 Name} as string,",
				"          {Speedbump 13 Desc} as string,",
				"          {Speedbump 13 Flag} as string,",
				"          {Speedbump 14 Name} as string,",
				"          {Speedbump 14 Desc} as string,",
				"          {Speedbump 14 Flag} as string,",
				"          {Speedbump 15 Name} as string,",
				"          {Speedbump 15 Desc} as string,",
				"          {Speedbump 15 Flag} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> Speedbumps",
				"Speedbumps alterRow(upsertIf(true()),",
				"     deleteIf(isNull({Client ID})),",
				"     deleteIf(isNull({Client Engagement Date})),",
				"     deleteIf(isNull({Worker ID})),",
				"     deleteIf(isNull({Event Year}))) ~> alterRow1",
				"alterRow1 derive(LoadDt = currentDate()) ~> derivedColumn1",
				"derivedColumn1 select(mapColumn(",
				"          ClientId = {Client ID},",
				"          ClientEngagementDt = {Client Engagement Date},",
				"          EventQuarter = {Event Quarter},",
				"          EventYear = {Event Year},",
				"          CoreEventId = {Core Event Id},",
				"          CoreEventQuarter = {Core Event Quarter},",
				"          CoreEventDate = {Core Event Date},",
				"          WorkerId = {Worker ID},",
				"          SpeedbumnpWorkerStatus = {Speedbump Worker Status},",
				"          SpeedbumpPopulationInd = {Speedbump Population Ind},",
				"          Speedbump1Name = {Speedbump 1 Name},",
				"          Speedbump1Desc = {Speedbump 1 Desc},",
				"          Speedbump1Flag = {Speedbump 1 Flag},",
				"          Speedbump2Name = {Speedbump 2 Name},",
				"          Speedbump2Desc = {Speedbump 2 Desc},",
				"          Speedbump2Flag = {Speedbump 2 Flag},",
				"          Speedbump3Name = {Speedbump 3 Name},",
				"          Speedbump3Desc = {Speedbump 3 Desc},",
				"          Speedbump3Flag = {Speedbump 3 Flag},",
				"          Speedbump4Name = {Speedbump 4 Name},",
				"          Speedbump4Desc = {Speedbump 4 Desc},",
				"          Speedbump4Flag = {Speedbump 4 Flag},",
				"          Speedbump5Name = {Speedbump 5 Name},",
				"          Speedbump5Desc = {Speedbump 5 Desc},",
				"          Speedbump5Flag = {Speedbump 5 Flag},",
				"          Speedbump6Name = {Speedbump 6 Name},",
				"          Speedbump6Desc = {Speedbump 6 Desc},",
				"          Speedbump6Flag = {Speedbump 6 Flag},",
				"          Speedbump7Name = {Speedbump 7 Name},",
				"          Speedbump7Desc = {Speedbump 7 Desc},",
				"          Speedbump7Flag = {Speedbump 7 Flag},",
				"          Speedbump8Name = {Speedbump 8 Name},",
				"          Speedbump8Desc = {Speedbump 8 Desc},",
				"          Speedbump8Flag = {Speedbump 8 Flag},",
				"          Speedbump9Name = {Speedbump 9 Name},",
				"          Speedbump9Desc = {Speedbump 9 Desc},",
				"          Speedbump9Flag = {Speedbump 9 Flag},",
				"          Speedbump10Name = {Speedbump 10 Name},",
				"          Speedbump10Desc = {Speedbump 10 Desc},",
				"          Speedbump10Flag = {Speedbump 10 Flag},",
				"          Speedbump11Name = {Speedbump 11 Name},",
				"          Speedbump11Desc = {Speedbump 11 Desc},",
				"          Speedbump11Flag = {Speedbump 11 Flag},",
				"          Speedbump12Name = {Speedbump 12 Name},",
				"          Speedbump12Desc = {Speedbump 12 Desc},",
				"          Speedbump12Flag = {Speedbump 12 Flag},",
				"          Speedbump13Name = {Speedbump 13 Name},",
				"          Speedbump13Desc = {Speedbump 13 Desc},",
				"          Speedbump13Flag = {Speedbump 13 Flag},",
				"          Speedbump14Name = {Speedbump 14 Name},",
				"          Speedbump14Desc = {Speedbump 14 Desc},",
				"          Speedbump14Flag = {Speedbump 14 Flag},",
				"          Speedbump15Name = {Speedbump 15 Name},",
				"          Speedbump15Desc = {Speedbump 15 Desc},",
				"          Speedbump15Flag = {Speedbump 15 Flag},",
				"          LoadDt",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"select1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          EventQuarter as integer,",
				"          EventYear as integer,",
				"          CoreEventId as string,",
				"          CoreEventQuarter as integer,",
				"          CoreEventDate as date,",
				"          WorkerId as string,",
				"          SpeedbumnpWorkerStatus as string,",
				"          SpeedbumpPopulationInd as string,",
				"          Speedbump1Name as string,",
				"          Speedbump1Desc as string,",
				"          Speedbump1Flag as string,",
				"          Speedbump2Name as string,",
				"          Speedbump2Desc as string,",
				"          Speedbump2Flag as string,",
				"          Speedbump3Name as string,",
				"          Speedbump3Desc as string,",
				"          Speedbump3Flag as string,",
				"          Speedbump4Name as string,",
				"          Speedbump4Desc as string,",
				"          Speedbump4Flag as string,",
				"          Speedbump5Name as string,",
				"          Speedbump5Desc as string,",
				"          Speedbump5Flag as string,",
				"          Speedbump6Name as string,",
				"          Speedbump6Desc as string,",
				"          Speedbump6Flag as string,",
				"          Speedbump7Name as string,",
				"          Speedbump7Desc as string,",
				"          Speedbump7Flag as string,",
				"          Speedbump8Name as string,",
				"          Speedbump8Desc as string,",
				"          Speedbump8Flag as string,",
				"          Speedbump9Name as string,",
				"          Speedbump9Desc as string,",
				"          Speedbump9Flag as string,",
				"          Speedbump10Name as string,",
				"          Speedbump10Desc as string,",
				"          Speedbump10Flag as string,",
				"          Speedbump11Name as string,",
				"          Speedbump11Desc as string,",
				"          Speedbump11Flag as string,",
				"          Speedbump12Name as string,",
				"          Speedbump12Desc as string,",
				"          Speedbump12Flag as string,",
				"          Speedbump13Name as string,",
				"          Speedbump13Desc as string,",
				"          Speedbump13Flag as string,",
				"          Speedbump14Name as string,",
				"          Speedbump14Desc as string,",
				"          Speedbump14Flag as string,",
				"          Speedbump15Name as string,",
				"          Speedbump15Desc as string,",
				"          Speedbump15Flag as string,",
				"          LoadDt as date",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:true,",
				"     keys:['ClientId','ClientEngagementDt','WorkerId','EventYear','EventQuarter'],",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          ClientId,",
				"          ClientEngagementDt,",
				"          EventQuarter,",
				"          EventYear,",
				"          CoreEventId,",
				"          CoreEventQuarter,",
				"          CoreEventDate,",
				"          WorkerId,",
				"          SpeedbumnpWorkerStatus,",
				"          SpeedbumpPopulationInd,",
				"          Speedbump1Name,",
				"          Speedbump1Desc,",
				"          Speedbump1Flag,",
				"          Speedbump2Name,",
				"          Speedbump2Desc,",
				"          Speedbump2Flag,",
				"          Speedbump3Name,",
				"          Speedbump3Desc,",
				"          Speedbump3Flag,",
				"          Speedbump4Name,",
				"          Speedbump4Desc,",
				"          Speedbump4Flag,",
				"          Speedbump5Name,",
				"          Speedbump5Desc,",
				"          Speedbump5Flag,",
				"          Speedbump6Name,",
				"          Speedbump6Desc,",
				"          Speedbump6Flag,",
				"          Speedbump7Name,",
				"          Speedbump7Desc,",
				"          Speedbump7Flag,",
				"          Speedbump8Name,",
				"          Speedbump8Desc,",
				"          Speedbump8Flag,",
				"          Speedbump9Name,",
				"          Speedbump9Desc,",
				"          Speedbump9Flag,",
				"          Speedbump10Name,",
				"          Speedbump10Desc,",
				"          Speedbump10Flag,",
				"          Speedbump11Name,",
				"          Speedbump11Desc,",
				"          Speedbump11Flag,",
				"          Speedbump12Name,",
				"          Speedbump12Desc,",
				"          Speedbump12Flag,",
				"          Speedbump13Name,",
				"          Speedbump13Desc,",
				"          Speedbump13Flag,",
				"          Speedbump14Name,",
				"          Speedbump14Desc,",
				"          Speedbump14Flag,",
				"          Speedbump15Name,",
				"          Speedbump15Desc,",
				"          Speedbump15Flag,",
				"          LoadDt",
				"     )) ~> sink1"
			]
		}
	}
}