{
	"name": "DF_FactTbl_Survey_Evergreen",
	"properties": {
		"folder": {
			"name": "Client/Adhoc"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "etalentPerfRatingHistFactTbl",
						"type": "DatasetReference"
					},
					"name": "PerfRatingHistory"
				},
				{
					"dataset": {
						"referenceName": "etalentCoreFactTbl",
						"type": "DatasetReference"
					},
					"name": "CoreYear"
				},
				{
					"dataset": {
						"referenceName": "etalentCorpTitleMapTbl",
						"type": "DatasetReference"
					},
					"name": "LevelMapForEmp"
				},
				{
					"dataset": {
						"referenceName": "etalentTalentFactTbl",
						"type": "DatasetReference"
					},
					"name": "Talent"
				},
				{
					"dataset": {
						"referenceName": "etalentOtherCoreFactTbl",
						"type": "DatasetReference"
					},
					"name": "OtherCore"
				},
				{
					"dataset": {
						"referenceName": "etalentCoreFactTbl",
						"type": "DatasetReference"
					},
					"name": "CoreForSupplement"
				},
				{
					"dataset": {
						"referenceName": "etalentEthnicityMapTbl",
						"type": "DatasetReference"
					},
					"name": "EthnicityMap"
				},
				{
					"dataset": {
						"referenceName": "etalentGenderMapTbl",
						"type": "DatasetReference"
					},
					"name": "GenderMap"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Source_FactTblFldr",
						"type": "DatasetReference"
					},
					"name": "OutPutFactTable"
				}
			],
			"transformations": [
				{
					"name": "SelectCurrYear"
				},
				{
					"name": "RemoveYearNullRows"
				},
				{
					"name": "SelectEmpLvlMap"
				},
				{
					"name": "SelectEmpTalentTag"
				},
				{
					"name": "Select1PYear"
				},
				{
					"name": "Select2PYear"
				},
				{
					"name": "Select3PYear"
				},
				{
					"name": "select6"
				},
				{
					"name": "SelectTalentColumns"
				},
				{
					"name": "FilterSurveyValuesCulture"
				},
				{
					"name": "SelectValuesCulture1P"
				},
				{
					"name": "FilterSurveyGoals"
				},
				{
					"name": "SelectGoalsCurr"
				},
				{
					"name": "FilterValues"
				},
				{
					"name": "SelectValuesCurr"
				},
				{
					"name": "HCTCurrent"
				},
				{
					"name": "HCT1P"
				},
				{
					"name": "HCT2P"
				},
				{
					"name": "WorkerID1P"
				},
				{
					"name": "WorkerID2P"
				},
				{
					"name": "HCTin1P"
				},
				{
					"name": "HCTin2P"
				},
				{
					"name": "JoinElloreeRace"
				},
				{
					"name": "JoinElloreeGender"
				},
				{
					"name": "SelectAllCore"
				},
				{
					"name": "HCTCurrMgr"
				},
				{
					"name": "HCT1PMgr"
				},
				{
					"name": "HCT2PMgr"
				},
				{
					"name": "unionAllWorkerMgr"
				},
				{
					"name": "GroupWorkerMgrCombo"
				},
				{
					"name": "SeleceWorkerMgrCombo"
				},
				{
					"name": "WorkerMgrCount"
				},
				{
					"name": "JoinMgrCount"
				},
				{
					"name": "SelectHCTCleanup"
				},
				{
					"name": "filter2"
				},
				{
					"name": "SelectGoalsImpactReach1P"
				},
				{
					"name": "filter3"
				},
				{
					"name": "SelectGoalsSeizeOpp1P"
				},
				{
					"name": "JoinGoalValCurr"
				},
				{
					"name": "JoinGoalImpactSeize1P"
				},
				{
					"name": "FilterSurveyGoalsSeize1P"
				},
				{
					"name": "FilterSurveyGoalsSeize2P"
				},
				{
					"name": "SelectGoalsSeizeOpp2P"
				},
				{
					"name": "FilterSurveyGoalsImpactReach1P"
				},
				{
					"name": "FilterSurveyGoalsSeize2PVal"
				},
				{
					"name": "SelectGoalsImpactReach2P"
				},
				{
					"name": "FilterSurveyGoalsCurr"
				},
				{
					"name": "FilterSurveyValuesCurr"
				},
				{
					"name": "JoinTalentTag"
				},
				{
					"name": "FilterSurveyValuesCulture1P"
				},
				{
					"name": "FilterSurveyValuesCulture2P"
				},
				{
					"name": "SelectValuesCulture2P"
				},
				{
					"name": "FilterValuesWorksCollab"
				},
				{
					"name": "FilterValuesWorksCollab1PYear"
				},
				{
					"name": "SelectValuesWorksCollab1PYear"
				},
				{
					"name": "FilterValuesWorksCollab2PYear"
				},
				{
					"name": "SelectValuesWorksCollab2PYear"
				},
				{
					"name": "FilterPotential"
				},
				{
					"name": "FilterPotentialCurr"
				},
				{
					"name": "SelectPotentialCurr"
				},
				{
					"name": "FilterPotentialBroaderResp"
				},
				{
					"name": "FilterPotentialBroadResp1P"
				},
				{
					"name": "SelectPotentialBroadResp1P"
				},
				{
					"name": "FilterPotentialBroadResp2P"
				},
				{
					"name": "SelectPotentialBroadResp2P"
				},
				{
					"name": "FilterPotentialLearningInnov"
				},
				{
					"name": "FilterPotentialLearnInnov2P"
				},
				{
					"name": "SelectPotentialLearnInnov2P"
				},
				{
					"name": "FilterPotentialLearnInnov1P"
				},
				{
					"name": "SelectPotentialLearnInnov1P"
				},
				{
					"name": "JoinGoalImpactSeize2P"
				},
				{
					"name": "JoinGoalImpactReach1P"
				},
				{
					"name": "JoinGoalImpactReach2P"
				},
				{
					"name": "JoinValuesCurr"
				},
				{
					"name": "JoinValuesCulture1P"
				},
				{
					"name": "JoinValuesCulture2P"
				},
				{
					"name": "JoinValuesWorksCollab1PYear"
				},
				{
					"name": "JoinValuesWorksCollab2PYear"
				},
				{
					"name": "JoinPotentialCurr"
				},
				{
					"name": "JoinPotentialBroadResp1P"
				},
				{
					"name": "JoinPotentialBroadResp2P"
				},
				{
					"name": "JoinPotentialLearnInnov1P"
				},
				{
					"name": "JoinPotentialLearnInnov2P"
				},
				{
					"name": "SelectFinalOutput"
				},
				{
					"name": "join1"
				}
			],
			"scriptLines": [
				"parameters{",
				"     SB_BL_Year as string,",
				"     SB_BL_Quarter as string,",
				"     Flow_Client_Id as string,",
				"     Flow_Client_Dt as string",
				"}",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          EventYear as integer,",
				"          WorkerId as string,",
				"          LastPerfYear as integer,",
				"          LastPerfRatingDt as date,",
				"          LastClientPerfRating as string,",
				"          LastElloreePerfRating as string,",
				"          LastElloreePerfRatingSortId as integer,",
				"          LastTopTalentInd as string,",
				"          CurrPerfYear as integer,",
				"          CurrPerfRatingDt as date,",
				"          CurrTalentTag as string,",
				"          CurrClientPerfRating as string,",
				"          CurrElloreePerfRating as string,",
				"          CurrElloreePerfRatingSortId as integer,",
				"          CurrTopTalentInd as string,",
				"          P1PerfYear as integer,",
				"          P1PerfRatingDt as date,",
				"          P1ClientPerfRating as string,",
				"          P1ElloreePerfRating as string,",
				"          P1ElloreePerfRatingSortId as integer,",
				"          P1TopTalentInd as string,",
				"          P2PerfYear as integer,",
				"          P2PerfRatingDt as date,",
				"          P2ClientPerfRating as string,",
				"          P2ElloreePerfRating as string,",
				"          P2ElloreePerfRatingSortId as integer,",
				"          P2TopTalentInd as string,",
				"          P3PerfYear as integer,",
				"          P3PerfRatingDt as date,",
				"          P3ClientPerfRating as string,",
				"          P3ElloreePerfRating as string,",
				"          P3ElloreePerfRatingSortId as integer,",
				"          P3TopTalentInd as string,",
				"          LastTalentTagYear as integer,",
				"          LastTalentTag as string,",
				"          LoadDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select * from [dbo].[PerfRatingHistTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}' and EventYear = '{$SB_BL_Year}'\"),",
				"     format: 'query') ~> PerfRatingHistory",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          WorkerId as string,",
				"          EventDt as date,",
				"          EventMonth as integer,",
				"          EventQuarter as integer,",
				"          EventYear as integer,",
				"          Event as string,",
				"          EventId as string,",
				"          EventType as string,",
				"          EventReason as string,",
				"          WorkerStatus as string,",
				"          WorkerType as string,",
				"          JobTitle as string,",
				"          JobFunction as string,",
				"          YearsinJob as double,",
				"          PrevJobTitle as string,",
				"          PrevJobFunction as string,",
				"          LastPromoDt as date,",
				"          OrigHireDt as date,",
				"          CurrHireDt as date,",
				"          RehireInd as string,",
				"          YearsofSrvc as double,",
				"          YearsofSrvcBand as string,",
				"          YearsofSrvcBandSortId as integer,",
				"          CorpTitle as string,",
				"          PrevCorpTitle as string,",
				"          ManagerInd as string,",
				"          DirectMgrWorkerId as string,",
				"          WorkOfficeLoc as string,",
				"          WorkOfficeCity as string,",
				"          WorkOfficeState as string,",
				"          WorkOfficeCountry as string,",
				"          WorkStrategicLocInd as string,",
				"          LegacyOrg as string,",
				"          BusinessGrpLvl1 as string,",
				"          BusinessGrpLvl2 as string,",
				"          BusinessGrpLvl3 as string,",
				"          BusinessGrpLvl4 as string,",
				"          Race as string,",
				"          HispanicLatinoOrigin as string,",
				"          Gender as string,",
				"          Veteran as string,",
				"          LGTBQ as string,",
				"          DisabilityInd as string,",
				"          BirthYear as integer,",
				"          Generation as string,",
				"          GenerationSortId as integer,",
				"          EmpCount as integer,",
				"          LoadDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select * from [dbo].[CoreFactTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}' and EventId = 'HCT' and EventYear = '{$SB_BL_Year}' and EventQuarter = '{$SB_BL_Quarter}'\"),",
				"     format: 'query') ~> CoreYear",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          ClientCorpTitle as string,",
				"          ClientElloreeCorpTitle as string,",
				"          ElloreeCorpTitle as string,",
				"          ElloreeCorpTitleSortId as integer,",
				"          LoadDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select * from [dbo].[CorpTitleMapTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}'\"),",
				"     format: 'query') ~> LevelMapForEmp",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          WorkerId as string,",
				"          EventYear as integer,",
				"          EventDt as date,",
				"          Event as string,",
				"          EventType as string,",
				"          PerfRating as string,",
				"          PerfRatingDt as date,",
				"          TalentIdentifier1 as string,",
				"          TalentIdentifier2 as string,",
				"          TalentIdentifier3 as string,",
				"          TalentIdentifier4 as string,",
				"          TalentIdentifier5 as string,",
				"          LoadDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select * from [dbo].[TalentFactTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}' and EventYear = '{$SB_BL_Year}'\"),",
				"     format: 'query') ~> Talent",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          WorkerId as string,",
				"          EventDt as date,",
				"          EventMonth as integer,",
				"          EventQuarter as integer,",
				"          EventYear as integer,",
				"          Event as string,",
				"          EventId as string,",
				"          EventDesc as string,",
				"          EventType as string,",
				"          OtherCharVal11 as string,",
				"          OtherCharVal2 as string,",
				"          OtherNumVal1 as double,",
				"          OtherNumVal2 as double,",
				"          OtherDtVal1 as date,",
				"          OtherDtVal2 as date,",
				"          LoadDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select * from [dbo].[OtherCoreFactTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}' and EventYear <= '{$SB_BL_Year}'\"),",
				"     format: 'query') ~> OtherCore",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          WorkerId as string,",
				"          EventDt as date,",
				"          EventMonth as integer,",
				"          EventQuarter as integer,",
				"          EventYear as integer,",
				"          Event as string,",
				"          EventId as string,",
				"          EventType as string,",
				"          EventReason as string,",
				"          WorkerStatus as string,",
				"          WorkerType as string,",
				"          JobTitle as string,",
				"          JobFunction as string,",
				"          YearsinJob as double,",
				"          PrevJobTitle as string,",
				"          PrevJobFunction as string,",
				"          LastPromoDt as date,",
				"          OrigHireDt as date,",
				"          CurrHireDt as date,",
				"          RehireInd as string,",
				"          YearsofSrvc as double,",
				"          YearsofSrvcBand as string,",
				"          YearsofSrvcBandSortId as integer,",
				"          CorpTitle as string,",
				"          PrevCorpTitle as string,",
				"          ManagerInd as string,",
				"          DirectMgrWorkerId as string,",
				"          WorkOfficeLoc as string,",
				"          WorkOfficeCity as string,",
				"          WorkOfficeState as string,",
				"          WorkOfficeCountry as string,",
				"          WorkStrategicLocInd as string,",
				"          LegacyOrg as string,",
				"          BusinessGrpLvl1 as string,",
				"          BusinessGrpLvl2 as string,",
				"          BusinessGrpLvl3 as string,",
				"          BusinessGrpLvl4 as string,",
				"          Race as string,",
				"          HispanicLatinoOrigin as string,",
				"          Gender as string,",
				"          Veteran as string,",
				"          LGTBQ as string,",
				"          DisabilityInd as string,",
				"          BirthYear as integer,",
				"          Generation as string,",
				"          GenerationSortId as integer,",
				"          EmpCount as integer,",
				"          LoadDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select * from [dbo].[CoreFactTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}' and EventId = 'HCT'\"),",
				"     format: 'query') ~> CoreForSupplement",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          ClientRace as string,",
				"          ClientHispanicLatinoOrigin as string,",
				"          ElloreeRace as string,",
				"          ElloreeHispanicLatinoOrigin as string,",
				"          ElloreeEthnicGroup as string,",
				"          LoadDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select * from [dbo].[EthnicityMapTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}'\"),",
				"     format: 'query') ~> EthnicityMap",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          ClientGender as string,",
				"          ElloreeGender as string,",
				"          LoadDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select * from [dbo].[GenderMapTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}'\"),",
				"     format: 'query') ~> GenderMap",
				"RemoveYearNullRows aggregate(groupBy({Client ID}),",
				"     MaxCurrYear = max({Event Year})) ~> SelectCurrYear",
				"select6 filter(!(isNull({Event Year}))) ~> RemoveYearNullRows",
				"LevelMapForEmp select(mapColumn(",
				"          {Emp Lvl Map Client Corporate Title} = ClientCorpTitle,",
				"          {Emp Lvl Map Elloree Corporate Title} = ElloreeCorpTitle,",
				"          {Emp Lvl Map Elloree Corporate Title Sort} = ElloreeCorpTitleSortId",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectEmpLvlMap",
				"PerfRatingHistory select(mapColumn(",
				"          {Emp Perf Rating Worker ID} = WorkerId,",
				"          {Emp Perf Rating Event Year} = EventYear,",
				"          {Emp Perf Rating Curr Talent Tag} = CurrTalentTag,",
				"          {Emp Curr Elloree Perf Rating} = CurrElloreePerfRating,",
				"          {Emp P1 Elloree Perf Rating} = P1ElloreePerfRating,",
				"          {Emp P2 Elloree Perf Rating} = P2ElloreePerfRating",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectEmpTalentTag",
				"RemoveYearNullRows aggregate(groupBy({Client ID}),",
				"     Max1PYear = max({Event Year})-1) ~> Select1PYear",
				"RemoveYearNullRows aggregate(groupBy({Client ID}),",
				"     Max2PYear = max({Event Year})-2) ~> Select2PYear",
				"RemoveYearNullRows aggregate(groupBy({Client ID}),",
				"     Max3PYear = max({Event Year})-3) ~> Select3PYear",
				"CoreYear select(mapColumn(",
				"          {Client ID} = ClientId,",
				"          {Client Engagement Date} = ClientEngagementDt,",
				"          {Worker ID} = WorkerId,",
				"          {Event Date} = EventDt,",
				"          EventMonth,",
				"          {Event Quarter} = EventQuarter,",
				"          {Event Year} = EventYear,",
				"          {Event Code} = EventId,",
				"          {Years of Service} = YearsofSrvc,",
				"          {Last Promo Date} = LastPromoDt,",
				"          {Corporate Title} = CorpTitle,",
				"          {Direct Manager Worker ID} = DirectMgrWorkerId,",
				"          EmpCount",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select6",
				"Talent select(mapColumn(",
				"          {Talent WorkerId} = WorkerId,",
				"          {Talent EventYear} = EventYear,",
				"          TalentIdentifier1,",
				"          TalentIdentifier2,",
				"          TalentIdentifier3,",
				"          TalentIdentifier4,",
				"          TalentIdentifier5",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectTalentColumns",
				"OtherCore filter(EventType=='Values - Culture and Values') ~> FilterSurveyValuesCulture",
				"FilterSurveyValuesCulture1P select(mapColumn(",
				"          WorkerId,",
				"          {Values 1P (Culture and Values)} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectValuesCulture1P",
				"OtherCore filter(EventType=='Goals') ~> FilterSurveyGoals",
				"FilterSurveyGoalsCurr select(mapColumn(",
				"          WorkerId,",
				"          {Goals Curr} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectGoalsCurr",
				"OtherCore filter(EventType=='Values') ~> FilterValues",
				"FilterSurveyValuesCurr select(mapColumn(",
				"          WorkerId,",
				"          {Values Curr} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectValuesCurr",
				"SelectAllCore, SelectCurrYear join(EventYear == MaxCurrYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> HCTCurrent",
				"SelectAllCore, Select1PYear join(EventYear == Max1PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> HCT1P",
				"SelectAllCore, Select2PYear join(EventYear == Max2PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> HCT2P",
				"HCT1P select(mapColumn(",
				"          {WorkerId 1P} = WorkerId",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> WorkerID1P",
				"HCT2P select(mapColumn(",
				"          {WorkerId 2P} = WorkerId",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> WorkerID2P",
				"HCTCurrent, WorkerID1P join(WorkerId == {WorkerId 1P},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> HCTin1P",
				"HCTin1P, WorkerID2P join(WorkerId == {WorkerId 2P},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> HCTin2P",
				"CoreForSupplement, EthnicityMap join(Race == ClientRace",
				"     && HispanicLatinoOrigin == ClientHispanicLatinoOrigin,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinElloreeRace",
				"JoinElloreeRace, GenderMap join(Gender == ClientGender,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinElloreeGender",
				"JoinTalentTag select(mapColumn(",
				"          ClientId = CoreForSupplement@ClientId,",
				"          ClientEngagementDt = CoreForSupplement@ClientEngagementDt,",
				"          WorkerId,",
				"          EventDt,",
				"          EventMonth,",
				"          EventQuarter,",
				"          EventYear,",
				"          Event,",
				"          EventId,",
				"          EventType,",
				"          EventReason,",
				"          WorkerStatus,",
				"          WorkerType,",
				"          JobTitle,",
				"          JobFunction,",
				"          YearsinJob,",
				"          PrevJobTitle,",
				"          PrevJobFunction,",
				"          LastPromoDt,",
				"          OrigHireDt,",
				"          CurrHireDt,",
				"          RehireInd,",
				"          YearsofSrvc,",
				"          YearsofSrvcBand,",
				"          YearsofSrvcBandSortId,",
				"          CorpTitle,",
				"          PrevCorpTitle,",
				"          ManagerInd,",
				"          DirectMgrWorkerId,",
				"          WorkOfficeLoc,",
				"          WorkOfficeCity,",
				"          WorkOfficeState,",
				"          WorkOfficeCountry,",
				"          WorkStrategicLocInd,",
				"          LegacyOrg,",
				"          BusinessGrpLvl1,",
				"          BusinessGrpLvl2,",
				"          BusinessGrpLvl3,",
				"          BusinessGrpLvl4,",
				"          Race,",
				"          HispanicLatinoOrigin,",
				"          Gender,",
				"          Veteran,",
				"          LGTBQ,",
				"          DisabilityInd,",
				"          BirthYear,",
				"          Generation,",
				"          GenerationSortId,",
				"          EmpCount,",
				"          ElloreeRace,",
				"          ElloreeHispanicLatinoOrigin,",
				"          ElloreeGender",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectAllCore",
				"HCTCurrent select(mapColumn(",
				"          WorkerId,",
				"          DirectMgrWorkerId",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> HCTCurrMgr",
				"HCT1P select(mapColumn(",
				"          WorkerId,",
				"          DirectMgrWorkerId",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> HCT1PMgr",
				"HCT2P select(mapColumn(",
				"          WorkerId,",
				"          DirectMgrWorkerId",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> HCT2PMgr",
				"HCTCurrMgr, HCT1PMgr, HCT2PMgr union(byName: true)~> unionAllWorkerMgr",
				"unionAllWorkerMgr aggregate(groupBy(WorkerId,",
				"          DirectMgrWorkerId),",
				"     RowCount = count(DirectMgrWorkerId)) ~> GroupWorkerMgrCombo",
				"GroupWorkerMgrCombo select(mapColumn(",
				"          WorkerId,",
				"          DirectMgrWorkerId",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SeleceWorkerMgrCombo",
				"SeleceWorkerMgrCombo aggregate(groupBy(WorkerId),",
				"     MgrCount = count(DirectMgrWorkerId)) ~> WorkerMgrCount",
				"HCTin2P, WorkerMgrCount join(SelectAllCore@WorkerId == WorkerMgrCount@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinMgrCount",
				"JoinMgrCount select(mapColumn(",
				"          ClientId,",
				"          ClientEngagementDt,",
				"          WorkerId = SelectAllCore@WorkerId,",
				"          EventDt,",
				"          EventMonth,",
				"          EventQuarter,",
				"          EventYear,",
				"          Event,",
				"          EventId,",
				"          EventType,",
				"          EventReason,",
				"          WorkerStatus,",
				"          WorkerType,",
				"          JobTitle,",
				"          JobFunction,",
				"          YearsinJob,",
				"          PrevJobTitle,",
				"          PrevJobFunction,",
				"          LastPromoDt,",
				"          OrigHireDt,",
				"          CurrHireDt,",
				"          RehireInd,",
				"          YearsofSrvc,",
				"          YearsofSrvcBand,",
				"          YearsofSrvcBandSortId,",
				"          CorpTitle,",
				"          PrevCorpTitle,",
				"          ManagerInd,",
				"          DirectMgrWorkerId,",
				"          MgrCount,",
				"          WorkOfficeLoc,",
				"          WorkOfficeCity,",
				"          WorkOfficeState,",
				"          WorkOfficeCountry,",
				"          WorkStrategicLocInd,",
				"          LegacyOrg,",
				"          BusinessGrpLvl1,",
				"          BusinessGrpLvl2,",
				"          BusinessGrpLvl3,",
				"          BusinessGrpLvl4,",
				"          Race,",
				"          ElloreeRace,",
				"          HispanicLatinoOrigin,",
				"          Gender,",
				"          ElloreeGender,",
				"          Veteran,",
				"          LGTBQ,",
				"          DisabilityInd,",
				"          BirthYear,",
				"          Generation,",
				"          GenerationSortId,",
				"          EmpCount,",
				"          ElloreeHispanicLatinoOrigin",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectHCTCleanup",
				"OtherCore filter(EventType=='Impact - Reach Qtrly Goals') ~> filter2",
				"FilterSurveyGoalsImpactReach1P select(mapColumn(",
				"          WorkerId,",
				"          {Goals 1P (Impact Reach) } = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectGoalsImpactReach1P",
				"OtherCore filter(EventType=='Impact - Seize Opportunities') ~> filter3",
				"FilterSurveyGoalsSeize1P select(mapColumn(",
				"          WorkerId,",
				"          {Goals 1P (Seize Opp) } = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectGoalsSeizeOpp1P",
				"SelectHCTCleanup, SelectGoalsCurr join(SelectHCTCleanup@WorkerId == SelectGoalsCurr@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinGoalValCurr",
				"JoinGoalValCurr, SelectGoalsSeizeOpp1P join(SelectHCTCleanup@WorkerId == SelectGoalsSeizeOpp1P@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinGoalImpactSeize1P",
				"filter3, Select1PYear join(EventYear == Max1PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterSurveyGoalsSeize1P",
				"filter3, Select2PYear join(EventYear == Max2PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterSurveyGoalsSeize2P",
				"FilterSurveyGoalsSeize2P select(mapColumn(",
				"          WorkerId,",
				"          {Goals 2P (Seize Opp) } = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectGoalsSeizeOpp2P",
				"filter2, Select1PYear join(EventYear == Max1PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterSurveyGoalsImpactReach1P",
				"filter2, Select2PYear join(EventYear == Max2PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterSurveyGoalsSeize2PVal",
				"FilterSurveyGoalsSeize2PVal select(mapColumn(",
				"          WorkerId,",
				"          {Goals 2P (Impact Reach) } = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectGoalsImpactReach2P",
				"FilterSurveyGoals, SelectCurrYear join(EventYear == MaxCurrYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterSurveyGoalsCurr",
				"FilterValues, SelectCurrYear join(EventYear == MaxCurrYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterSurveyValuesCurr",
				"JoinElloreeGender, SelectEmpTalentTag join(WorkerId == {Emp Perf Rating Worker ID}",
				"     && EventYear == {Emp Perf Rating Event Year},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinTalentTag",
				"FilterSurveyValuesCulture, Select1PYear join(EventYear == Max1PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterSurveyValuesCulture1P",
				"FilterSurveyValuesCulture, Select2PYear join(EventYear == Max2PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterSurveyValuesCulture2P",
				"FilterSurveyValuesCulture2P select(mapColumn(",
				"          WorkerId,",
				"          {Values 2P (Culture and Values)} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectValuesCulture2P",
				"OtherCore filter(EventType=='Values - Works collaboratively') ~> FilterValuesWorksCollab",
				"FilterValuesWorksCollab, Select1PYear join(EventYear == Max1PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterValuesWorksCollab1PYear",
				"FilterValuesWorksCollab1PYear select(mapColumn(",
				"          WorkerId,",
				"          {Values 1P (Works Collaboratively)} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectValuesWorksCollab1PYear",
				"FilterValuesWorksCollab, Select2PYear join(EventYear == Max2PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterValuesWorksCollab2PYear",
				"FilterValuesWorksCollab2PYear select(mapColumn(",
				"          WorkerId,",
				"          {Values 2P (Works Collaboratively)} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectValuesWorksCollab2PYear",
				"OtherCore filter(EventType=='Potential') ~> FilterPotential",
				"FilterPotential, SelectCurrYear join(EventYear == MaxCurrYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterPotentialCurr",
				"FilterPotentialCurr select(mapColumn(",
				"          WorkerId,",
				"          {Potential Curr} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectPotentialCurr",
				"OtherCore filter(EventType=='G&P - Broader Responsibilities') ~> FilterPotentialBroaderResp",
				"FilterPotentialBroaderResp, Select1PYear join(EventYear == Max1PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterPotentialBroadResp1P",
				"FilterPotentialBroadResp1P select(mapColumn(",
				"          WorkerId,",
				"          {Potential 1P (G&P - Broader Responsibilities)} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectPotentialBroadResp1P",
				"FilterPotentialBroaderResp, Select2PYear join(EventYear == Max2PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterPotentialBroadResp2P",
				"FilterPotentialBroadResp2P select(mapColumn(",
				"          WorkerId,",
				"          {Potential 2P (G&P - Broader Responsibilities)} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectPotentialBroadResp2P",
				"OtherCore filter(EventType=='G&P - Learning and Innovation') ~> FilterPotentialLearningInnov",
				"FilterPotentialLearningInnov, Select2PYear join(EventYear == Max2PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterPotentialLearnInnov2P",
				"FilterPotentialLearnInnov2P select(mapColumn(",
				"          WorkerId,",
				"          {Potential 2P (G&P - Learning and Innovation)} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectPotentialLearnInnov2P",
				"FilterPotentialLearningInnov, Select1PYear join(EventYear == Max1PYear,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FilterPotentialLearnInnov1P",
				"FilterPotentialLearnInnov1P select(mapColumn(",
				"          WorkerId,",
				"          {Potential 1P (G&P - Learning and Innovation)} = OtherCharVal11",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectPotentialLearnInnov1P",
				"JoinGoalImpactSeize1P, SelectGoalsSeizeOpp2P join(SelectHCTCleanup@WorkerId == SelectGoalsSeizeOpp2P@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinGoalImpactSeize2P",
				"JoinGoalImpactSeize2P, SelectGoalsImpactReach1P join(SelectHCTCleanup@WorkerId == SelectGoalsImpactReach1P@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinGoalImpactReach1P",
				"JoinGoalImpactReach1P, SelectGoalsImpactReach2P join(SelectHCTCleanup@WorkerId == SelectGoalsImpactReach2P@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinGoalImpactReach2P",
				"JoinGoalImpactReach2P, SelectValuesCurr join(SelectHCTCleanup@WorkerId == SelectValuesCurr@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinValuesCurr",
				"JoinValuesCurr, SelectValuesCulture1P join(SelectHCTCleanup@WorkerId == SelectValuesCulture1P@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinValuesCulture1P",
				"JoinValuesCulture1P, SelectValuesCulture2P join(SelectHCTCleanup@WorkerId == SelectValuesCulture2P@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinValuesCulture2P",
				"JoinValuesCulture2P, SelectValuesWorksCollab1PYear join(SelectHCTCleanup@WorkerId == SelectValuesWorksCollab1PYear@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinValuesWorksCollab1PYear",
				"JoinValuesWorksCollab1PYear, SelectValuesWorksCollab2PYear join(SelectHCTCleanup@WorkerId == SelectValuesWorksCollab2PYear@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinValuesWorksCollab2PYear",
				"JoinValuesWorksCollab2PYear, SelectPotentialCurr join(SelectHCTCleanup@WorkerId == SelectPotentialCurr@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinPotentialCurr",
				"JoinPotentialCurr, SelectPotentialBroadResp1P join(SelectHCTCleanup@WorkerId == SelectPotentialBroadResp1P@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinPotentialBroadResp1P",
				"JoinPotentialBroadResp1P, SelectPotentialBroadResp2P join(SelectHCTCleanup@WorkerId == SelectPotentialBroadResp2P@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinPotentialBroadResp2P",
				"JoinPotentialBroadResp2P, SelectPotentialLearnInnov1P join(SelectHCTCleanup@WorkerId == SelectPotentialLearnInnov1P@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinPotentialLearnInnov1P",
				"JoinPotentialLearnInnov1P, SelectPotentialLearnInnov2P join(SelectHCTCleanup@WorkerId == SelectPotentialLearnInnov2P@WorkerId,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinPotentialLearnInnov2P",
				"join1 select(mapColumn(",
				"          ClientId,",
				"          ClientEngagementDt,",
				"          WorkerId = SelectHCTCleanup@WorkerId,",
				"          EventDt,",
				"          EventMonth,",
				"          EventQuarter,",
				"          EventYear,",
				"          Event,",
				"          EventId,",
				"          EventType,",
				"          EventReason,",
				"          WorkerStatus,",
				"          WorkerType,",
				"          JobTitle,",
				"          JobFunction,",
				"          YearsinJob,",
				"          PrevJobTitle,",
				"          PrevJobFunction,",
				"          LastPromoDt,",
				"          OrigHireDt,",
				"          CurrHireDt,",
				"          RehireInd,",
				"          YearsofSrvc,",
				"          YearsofSrvcBand,",
				"          YearsofSrvcBandSortId,",
				"          CorpTitle,",
				"          PrevCorpTitle,",
				"          ManagerInd,",
				"          DirectMgrWorkerId,",
				"          MgrCount,",
				"          WorkOfficeLoc,",
				"          WorkOfficeCity,",
				"          WorkOfficeState,",
				"          WorkOfficeCountry,",
				"          WorkStrategicLocInd,",
				"          LegacyOrg,",
				"          BusinessGrpLvl1,",
				"          BusinessGrpLvl2,",
				"          BusinessGrpLvl3,",
				"          BusinessGrpLvl4,",
				"          Race,",
				"          ElloreeRace,",
				"          HispanicLatinoOrigin,",
				"          Gender,",
				"          ElloreeGender,",
				"          Veteran,",
				"          LGTBQ,",
				"          DisabilityInd,",
				"          BirthYear,",
				"          Generation,",
				"          GenerationSortId,",
				"          ElloreeHispanicLatinoOrigin,",
				"          {Goals Curr},",
				"          {Goals 1P (Seize Opp) },",
				"          {Goals 2P (Seize Opp) },",
				"          {Goals 1P (Impact Reach) },",
				"          {Goals 2P (Impact Reach) },",
				"          {Values Curr},",
				"          {Values 1P (Culture and Values)},",
				"          {Values 2P (Culture and Values)},",
				"          {Values 1P (Works Collaboratively)},",
				"          {Values 2P (Works Collaboratively)},",
				"          {Potential Curr},",
				"          {Potential 1P (G&P - Broader Responsibilities)},",
				"          {Potential 2P (G&P - Broader Responsibilities)},",
				"          {Potential 1P (G&P - Learning and Innovation)},",
				"          {Potential 2P (G&P - Learning and Innovation)},",
				"          {Emp Perf Rating Curr Talent Tag},",
				"          EmpCount",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectFinalOutput",
				"JoinPotentialLearnInnov2P, SelectEmpTalentTag join(SelectHCTCleanup@WorkerId == {Emp Perf Rating Worker ID},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"SelectFinalOutput sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          Column_1 as string,",
				"          Column_2 as string,",
				"          Column_3 as string,",
				"          Column_4 as string,",
				"          Column_5 as string,",
				"          Column_6 as string,",
				"          Column_7 as string,",
				"          Column_8 as string,",
				"          Column_9 as string,",
				"          Column_10 as string,",
				"          Column_11 as string,",
				"          Column_12 as string,",
				"          Column_13 as string,",
				"          Column_14 as string,",
				"          Column_15 as string,",
				"          Column_16 as string,",
				"          Column_17 as string,",
				"          Column_18 as string,",
				"          Column_19 as string,",
				"          Column_20 as string,",
				"          Column_21 as string,",
				"          Column_22 as string,",
				"          Column_23 as string,",
				"          Column_24 as string,",
				"          Column_25 as string,",
				"          Column_26 as string,",
				"          Column_27 as string,",
				"          Column_28 as string",
				"     ),",
				"     partitionFileNames:['Evergreen_Adhoc1.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> OutPutFactTable"
			]
		}
	}
}