{
	"name": "DF_Mapping_Job",
	"properties": {
		"description": "This workflow outputs 1 file for review of ethnicity values across events and time periods.",
		"folder": {
			"name": "Client/Mapping Tables"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "etalentCoreFactTbl",
						"type": "DatasetReference"
					},
					"name": "AllCoreData"
				},
				{
					"dataset": {
						"referenceName": "etalentJobMapTbl",
						"type": "DatasetReference"
					},
					"name": "JobMappingTableClient"
				},
				{
					"dataset": {
						"referenceName": "etalentReqFactTbl",
						"type": "DatasetReference"
					},
					"name": "Requisitions"
				},
				{
					"dataset": {
						"referenceName": "etalentCoreFactTbl",
						"type": "DatasetReference"
					},
					"name": "DatabaseCoreRecords"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Source_MappingPrepFldr",
						"type": "DatasetReference"
					},
					"name": "OutputMappingToPrepFldr"
				},
				{
					"dataset": {
						"referenceName": "Source_MappingWorkingFldr",
						"type": "DatasetReference"
					},
					"name": "OutputMappingToWorkingFldr"
				}
			],
			"transformations": [
				{
					"name": "CreatePivotCorpTitleEventTime"
				},
				{
					"name": "SortOnEvent"
				},
				{
					"name": "SortOnCorpTitle"
				},
				{
					"name": "SelectUniqueOtherClientValues"
				},
				{
					"name": "SelectExistingCorpTitleMapping"
				},
				{
					"name": "JoinCurrJobInfo"
				},
				{
					"name": "select5"
				},
				{
					"name": "join5"
				},
				{
					"name": "derivedColumn2"
				},
				{
					"name": "select6"
				},
				{
					"name": "JoinPrevInfo"
				},
				{
					"name": "select7"
				},
				{
					"name": "join6"
				},
				{
					"name": "select8"
				},
				{
					"name": "derivedColumn3"
				},
				{
					"name": "PullCorpTitleValuesNotInCurrTitleField"
				},
				{
					"name": "UnionCurrAndPrevCorpTitleRows"
				},
				{
					"name": "derivedColumn4"
				},
				{
					"name": "SelectJobColumns"
				},
				{
					"name": "select10"
				},
				{
					"name": "AddReqDerivedForUnion"
				},
				{
					"name": "JoinCoreAndReqRecords"
				},
				{
					"name": "selectCoreDBRecs"
				},
				{
					"name": "RemoveDups"
				},
				{
					"name": "derivedColumn5"
				},
				{
					"name": "aggregate2"
				},
				{
					"name": "GetCountOfClientForUniqueValues"
				},
				{
					"name": "JoinClientIDCountInForMaxFilter"
				},
				{
					"name": "CleanupSelectFields"
				},
				{
					"name": "SelectMappingWithMostClients"
				},
				{
					"name": "aggregate3"
				},
				{
					"name": "JoinBackFinalSelectMapping"
				},
				{
					"name": "TakeLastClientValForRemainingDups"
				},
				{
					"name": "NotEqualtoClientID"
				},
				{
					"name": "EqualtoClientId"
				},
				{
					"name": "GroupUniqueValues"
				},
				{
					"name": "selectUniqueClientIDValues"
				},
				{
					"name": "select11"
				},
				{
					"name": "SelectLastEngagementDt"
				},
				{
					"name": "SelectBasedOnMostRecentClientEngagment"
				}
			],
			"scriptLines": [
				"parameters{",
				"     Flow_Client_Id as string,",
				"     Flow_Client_Dt as string",
				"}",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          ClientEngagementType as string,",
				"          WorkerId as string,",
				"          EventDt as date,",
				"          EventMonth as integer,",
				"          EventQuarter as integer,",
				"          EventYear as integer,",
				"          Event as string,",
				"          EventId as string,",
				"          EventType as string,",
				"          EventReason as string,",
				"          WorkerStatus as string,",
				"          WorkerType as string,",
				"          JobTitle as string,",
				"          JobFunction as string,",
				"          YearsinJob as double,",
				"          PrevJobTitle as string,",
				"          PrevJobFunction as string,",
				"          LastPromoDt as date,",
				"          OrigHireDt as date,",
				"          CurrHireDt as date,",
				"          RehireInd as string,",
				"          YearsofSrvc as double,",
				"          YearsofSrvcBand as string,",
				"          YearsofSrvcBandSortId as integer,",
				"          CorpTitle as string,",
				"          PrevCorpTitle as string,",
				"          ManagerInd as string,",
				"          DirectMgrWorkerId as string,",
				"          WorkOfficeLoc as string,",
				"          WorkOfficeCity as string,",
				"          WorkOfficeState as string,",
				"          WorkOfficeCountry as string,",
				"          WorkStrategicLocInd as string,",
				"          LegacyOrg as string,",
				"          BusinessGrpLvl1 as string,",
				"          BusinessGrpLvl2 as string,",
				"          BusinessGrpLvl3 as string,",
				"          BusinessGrpLvl4 as string,",
				"          Race as string,",
				"          HispanicLatinoOrigin as string,",
				"          Gender as string,",
				"          Veteran as string,",
				"          LGTBQ as string,",
				"          DisabilityInd as string,",
				"          BirthYear as integer,",
				"          Generation as string,",
				"          GenerationSortId as integer,",
				"          EmpCount as integer,",
				"          LoadDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> AllCoreData",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          ClientCorpTitle as string,",
				"          ClientJobTitle as string,",
				"          ClientJobFunction as string,",
				"          ElloreeJobFunction as string,",
				"          LoadDt as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> JobMappingTableClient",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          CorpTitle as string,",
				"          JobTitle as string,",
				"          JobFunction as string,",
				"          EventYear as integer,",
				"          Event as string,",
				"          ReqId as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select ClientId, ClientEngagementDt, CorpTitle, JobTitle, JobFunction, EventYear, Event, ReqId from [dbo].[TAReqTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}'\"),",
				"     format: 'query') ~> Requisitions",
				"source(output(",
				"          ClientId as string,",
				"          ClientEngagementDt as date,",
				"          WorkerId as string,",
				"          EventYear as integer,",
				"          Event as string,",
				"          CorpTitle as string,",
				"          PrevCorpTitle as string,",
				"          JobTitle as string,",
				"          PrevJobTitle as string,",
				"          JobFunction as string,",
				"          PrevJobFunction as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: (\"select ClientId, ClientEngagementDt, WorkerId, EventYear, Event, CorpTitle, PrevCorpTitle, JobTitle, PrevJobTitle, JobFunction, PrevJobFunction from [dbo].[CoreFactTbl] where ClientId = '{$Flow_Client_Id}' and ClientEngagementDt = '{$Flow_Client_Dt}'\"),",
				"     format: 'query') ~> DatabaseCoreRecords",
				"derivedColumn4 pivot(groupBy({Client ID},",
				"          {Client Engagement Date},",
				"          {Client Corporate Title},",
				"          {Elloree Corporate Title},",
				"          {Client Elloree Corporate Title},",
				"          {Elloree Corporate Title Sort},",
				"          {Suggested Elloree Corporate Title} = {Suggested Elloree Job Function},",
				"          {Suggested Client Elloree Corporate Title},",
				"          {Suggested Elloree Corporate Title Sort},",
				"          {Suggested Source}),",
				"     pivotBy({Event and Year}),",
				"     {} = count({Worker ID}),",
				"     columnNaming: '$N$V',",
				"     lateral: false,",
				"     partitionBy('hash', 1)) ~> CreatePivotCorpTitleEventTime",
				"derivedColumn5 sort(asc({Event Year}, true)) ~> SortOnEvent",
				"CreatePivotCorpTitleEventTime sort(asc({Client Corporate Title}, true)) ~> SortOnCorpTitle",
				"NotEqualtoClientID aggregate(groupBy({Unique ClientId} = ClientId,",
				"          {Unique ClientCorpTitle} = ClientCorpTitle,",
				"          {Unique ClientJobTitle} = ClientJobTitle,",
				"          {Unique ClientJobFunction} = ClientJobFunction,",
				"          {Unique ElloreeJobFunction} = ElloreeJobFunction,",
				"          ClientEngagementDt),",
				"     CountClientId = count(ClientId)) ~> SelectUniqueOtherClientValues",
				"TakeLastClientValForRemainingDups select(mapColumn(",
				"          {Unique ClientId},",
				"          {Unique ClientCorpTitle},",
				"          {Unique ClientJobTitle},",
				"          {Unique ClientJobFunction},",
				"          {Unique ElloreeJobFunction}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectExistingCorpTitleMapping",
				"SortOnEvent, selectUniqueClientIDValues join({Client ID} == {Unique ClientId}",
				"     && {Corporate Title} == {Unique ClientCorpTitle}",
				"     && {Job Title} == {Unique ClientJobTitle}",
				"     && {Job Function} == {Unique CllientJobFunction},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinCurrJobInfo",
				"JoinCurrJobInfo select(mapColumn(",
				"          {Client Corporate Title} = {Corporate Title},",
				"          {Client Job Title} = {Job Title},",
				"          {Client Job Function} = {Job Function},",
				"          {Elloree Job Function},",
				"          {Client ID},",
				"          {Client Engagement Date},",
				"          {Event and Year},",
				"          {Suggested Source} = {Unique ClientId},",
				"          {Suggested Elloree Job Function} = {Unique ElloreeJobFunction},",
				"          {Worker ID} = RecordID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select5",
				"select5, SelectExistingCorpTitleMapping join({Client Corporate Title} == {Unique ClientCorpTitle}",
				"     && {Client Job Title} == {Unique ClientJobTitle}",
				"     && {Client Job Function} == {Unique ClientJobFunction}",
				"     && {Client ID} != {Unique ClientId},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'both')~> join5",
				"select6 derive({Suggested Source} = iif(isNull({Suggested Source}),{Unique ClientId},{Suggested Source}),",
				"          {Suggested Elloree Job Function} = iif(isNull({Suggested Source}),{Unique ElloreeJobFunction},{Suggested Elloree Job Function}),",
				"          {Job Function (Current or Previous)} = 'Curr Function') ~> derivedColumn2",
				"join5 select(mapColumn(",
				"          {Client Corporate Title},",
				"          {Client Job Title},",
				"          {Client Job Function},",
				"          {Elloree Job Function},",
				"          {Client ID},",
				"          {Client Engagement Date},",
				"          {Event and Year},",
				"          {Suggested Source},",
				"          {Suggested Elloree Job Function},",
				"          {Worker ID},",
				"          {Unique ClientId},",
				"          {Unique ClientCorporateTitle} = {Unique ClientCorpTitle},",
				"          {Unique ClientJobTitle},",
				"          {Unique ClientJobFunction},",
				"          {Unique ElloreeJobFunction}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select6",
				"SortOnEvent, selectUniqueClientIDValues join({Client ID} == {Unique ClientId}",
				"     && {Prev Corporate Title} == {Unique ClientCorpTitle}",
				"     && {Prev Job Title} == {Unique ClientJobTitle}",
				"     && {Prev Job Function} == {Unique CllientJobFunction},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinPrevInfo",
				"JoinPrevInfo select(mapColumn(",
				"          {Client ID},",
				"          {Client Engagement Date},",
				"          {Client Corporate Title} = {Prev Corporate Title},",
				"          {Client Job Title} = {Prev Job Title},",
				"          {Client Job Function} = {Prev Job Function},",
				"          {Elloree Job Function},",
				"          {Event and Year},",
				"          {Suggested Source} = {Unique ClientId},",
				"          {Suggested Elloree Job Function} = {Unique ElloreeJobFunction},",
				"          {Worker ID} = RecordID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select7",
				"select7, SelectExistingCorpTitleMapping join({Client Corporate Title} == {Unique ClientCorpTitle}",
				"     && {Client Job Title} == {Unique ClientJobTitle}",
				"     && {Client Job Function} == {Unique ClientJobFunction}",
				"     && {Client ID} != {Unique ClientId},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'both')~> join6",
				"join6 select(mapColumn(",
				"          {Client Corporate Title},",
				"          {Client Job Title},",
				"          {Client Job Function},",
				"          {Elloree Job Function},",
				"          {Client ID},",
				"          {Client Engagement Date},",
				"          {Event and Year},",
				"          {Suggested Source},",
				"          {Suggested Elloree Job Function},",
				"          {Worker ID},",
				"          {Unique ClientId},",
				"          {Unique ClientCorporateTitle} = {Unique ClientCorpTitle},",
				"          {Unique ClientJobTitle},",
				"          {Unique ClientJobFunction},",
				"          {Unique ElloreeJobFunction}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select8",
				"select8 derive({Suggested Source} = iif(isNull({Suggested Source}),{Unique ClientId},{Suggested Source}),",
				"          {Suggested Elloree Job Function} = iif(isNull({Suggested Source}),{Unique ElloreeJobFunction},{Suggested Elloree Job Function}),",
				"          {Job Function (Current or Previous)} = 'Prev Function') ~> derivedColumn3",
				"select11, derivedColumn2 exists(select11@{Client Corporate Title} == select6@{Client Corporate Title},",
				"     negate:true,",
				"     broadcast: 'both')~> PullCorpTitleValuesNotInCurrTitleField",
				"derivedColumn2, PullCorpTitleValuesNotInCurrTitleField union(byName: true)~> UnionCurrAndPrevCorpTitleRows",
				"UnionCurrAndPrevCorpTitleRows derive({Event and Year} = concat({Event and Year},concat(' ',{Job Function (Current or Previous)}))) ~> derivedColumn4",
				"Requisitions select(mapColumn(",
				"          {Client ID} = ClientId,",
				"          {Client Engagement Date} = ClientEngagementDt,",
				"          {Corporate Title} = CorpTitle,",
				"          {Job Title} = JobTitle,",
				"          {Job Function} = JobFunction,",
				"          {Event Year} = EventYear,",
				"          Event,",
				"          RecordID = ReqId",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectJobColumns",
				"AllCoreData select(mapColumn(",
				"          {Client ID} = ClientId,",
				"          {Client Engagement Date} = ClientEngagementDt,",
				"          {Event Year} = EventYear,",
				"          Event,",
				"          {Job Title} = JobTitle,",
				"          {Job Function} = JobFunction,",
				"          {Prev Job Title} = PrevJobTitle,",
				"          {Prev Job Function} = PrevJobFunction,",
				"          {Corporate Title} = CorpTitle,",
				"          {Prev Corporate Title} = PrevCorpTitle,",
				"          RecordID = WorkerId",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select10",
				"SelectJobColumns derive({Prev Corporate Title} = 'N/A',",
				"          {Prev Job Title} = 'N/A',",
				"          {Prev Job Function} = 'N/A') ~> AddReqDerivedForUnion",
				"select10, AddReqDerivedForUnion, selectCoreDBRecs union(byName: true)~> JoinCoreAndReqRecords",
				"aggregate2 select(mapColumn(",
				"          {Client ID} = ClientId,",
				"          {Client Engagement Date} = ClientEngagementDt,",
				"          RecordID = WorkerId,",
				"          {Event Year} = EventYear,",
				"          Event,",
				"          {Corporate Title} = CorpTitle,",
				"          {Prev Corporate Title} = PrevCorpTitle,",
				"          {Job Title} = JobTitle,",
				"          {Prev Job Title} = PrevJobTitle,",
				"          {Job Function} = JobFunction,",
				"          {Prev Job Function} = PrevJobFunction",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectCoreDBRecs",
				"JoinCoreAndReqRecords aggregate(groupBy({Client Engagement Date},",
				"          {Event Year},",
				"          Event,",
				"          {Corporate Title},",
				"          {Prev Corporate Title},",
				"          {Job Title},",
				"          {Prev Job Title},",
				"          {Job Function},",
				"          {Prev Job Function},",
				"          RecordID),",
				"     {Client ID} = max({Client ID})) ~> RemoveDups",
				"RemoveDups derive({Event and Year} = concat(toString({Event Year}),concat(' ',Event)),",
				"          {Elloree Job Function} = '') ~> derivedColumn5",
				"DatabaseCoreRecords aggregate(groupBy(ClientId,",
				"          ClientEngagementDt,",
				"          WorkerId,",
				"          EventYear,",
				"          Event,",
				"          CorpTitle,",
				"          PrevCorpTitle,",
				"          JobTitle,",
				"          PrevJobTitle,",
				"          JobFunction,",
				"          PrevJobFunction),",
				"     TotWorkers = count(WorkerId)) ~> aggregate2",
				"SelectUniqueOtherClientValues aggregate(groupBy({Count Unique ClientCorpTitle} = {Unique ClientCorpTitle},",
				"          {Count Unique ClientJobTitle} = {Unique ClientJobTitle},",
				"          {Count Unique ClientJobFunction} = {Unique ClientJobFunction},",
				"          {Count Unique ElloreeJobFunction} = {Unique ElloreeJobFunction}),",
				"     ClientIDCount = count({Unique ClientId})) ~> GetCountOfClientForUniqueValues",
				"SelectUniqueOtherClientValues, GetCountOfClientForUniqueValues join({Unique ClientCorpTitle} == {Count Unique ClientCorpTitle}",
				"     && {Unique ClientJobTitle} == {Count Unique ClientJobTitle}",
				"     && {Unique ClientJobFunction} == {Count Unique ClientJobFunction}",
				"     && {Unique ElloreeJobFunction} == {Count Unique ElloreeJobFunction},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinClientIDCountInForMaxFilter",
				"JoinClientIDCountInForMaxFilter select(mapColumn(",
				"          {Unique ClientId},",
				"          ClientEngagementDt,",
				"          {Unique ClientCorpTitle},",
				"          {Unique ClientJobTitle},",
				"          {Unique ClientJobFunction},",
				"          {Unique ElloreeJobFunction},",
				"          ClientIDCount",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> CleanupSelectFields",
				"CleanupSelectFields aggregate(groupBy({Unique ClientId},",
				"          {Unique ClientCorpTitle},",
				"          {Unique ClientJobTitle},",
				"          {Unique ClientJobFunction},",
				"          {Unique ElloreeJobFunction}),",
				"     ClientIDCount = max(ClientIDCount),",
				"          ClientEngagementDt = max(ClientEngagementDt)) ~> SelectMappingWithMostClients",
				"SelectMappingWithMostClients aggregate(groupBy({Agg Unique ClientCorpTitle} = {Unique ClientCorpTitle},",
				"          {Agg Unique ClientJobTitle} = {Unique ClientJobTitle},",
				"          {Agg Unique ClientJobFunction} = {Unique ClientJobFunction}),",
				"     {Agg Unique ElloreeJobFunction} = first({Unique ElloreeJobFunction})) ~> aggregate3",
				"SelectMappingWithMostClients, aggregate3 join({Unique ClientCorpTitle} == {Agg Unique ClientCorpTitle}",
				"     && {Unique ClientJobTitle} == {Agg Unique ClientJobTitle}",
				"     && {Unique ClientJobFunction} == {Agg Unique ClientJobFunction}",
				"     && {Unique ElloreeJobFunction} == {Agg Unique ElloreeJobFunction},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinBackFinalSelectMapping",
				"JoinBackFinalSelectMapping aggregate(groupBy({Unique ClientCorpTitle},",
				"          {Unique ClientJobTitle},",
				"          {Unique ClientJobFunction},",
				"          {Unique ElloreeJobFunction}),",
				"     {Unique ClientId} = last({Unique ClientId})) ~> TakeLastClientValForRemainingDups",
				"JobMappingTableClient filter(ClientId!=$Flow_Client_Id) ~> NotEqualtoClientID",
				"JobMappingTableClient filter(ClientId==$Flow_Client_Id) ~> EqualtoClientId",
				"EqualtoClientId aggregate(groupBy({Unique ClientId} = ClientId,",
				"          {Unique ClientCorpTitle} = ClientCorpTitle,",
				"          {Unique ClientJobTitle} = ClientJobTitle,",
				"          {Unique ClientJobFunction} = ClientJobFunction,",
				"          {Unique ElloreeJobFunction} = ElloreeJobFunction,",
				"          ClientEngagementDt),",
				"     RowCount = count(ClientId)) ~> GroupUniqueValues",
				"SelectBasedOnMostRecentClientEngagment select(mapColumn(",
				"          {Unique ClientId},",
				"          {Unique ClientCorpTitle},",
				"          {Unique ClientJobTitle},",
				"          {Unique CllientJobFunction} = {Unique ClientJobFunction},",
				"          {Unique ElloreeJobFunction}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectUniqueClientIDValues",
				"derivedColumn3 select(mapColumn(",
				"          {Client ID},",
				"          {Client Engagement Date},",
				"          {Client Corporate Title},",
				"          {Client Job Title},",
				"          {Client Job Function},",
				"          {Elloree Job Function},",
				"          {Event and Year},",
				"          {Suggested Source},",
				"          {Suggested Elloree Job Function},",
				"          {Worker ID},",
				"          {Job Function (Current or Previous)}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select11",
				"GroupUniqueValues aggregate(LastEngagementDt = max(ClientEngagementDt)) ~> SelectLastEngagementDt",
				"GroupUniqueValues, SelectLastEngagementDt exists(ClientEngagementDt == LastEngagementDt,",
				"     negate:false,",
				"     broadcast: 'both')~> SelectBasedOnMostRecentClientEngagment",
				"SortOnCorpTitle sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          Column_1 as string,",
				"          Column_2 as string,",
				"          Column_3 as string,",
				"          Column_4 as string,",
				"          Column_5 as string,",
				"          Column_6 as string,",
				"          Column_7 as string,",
				"          Column_8 as string,",
				"          Column_9 as string,",
				"          Column_10 as string,",
				"          Column_11 as string,",
				"          Column_12 as string,",
				"          Column_13 as string,",
				"          Column_14 as string,",
				"          Column_15 as string,",
				"          Column_16 as string,",
				"          Column_17 as string,",
				"          Column_18 as string,",
				"          Column_19 as string,",
				"          Column_20 as string,",
				"          Column_21 as string,",
				"          Column_22 as string,",
				"          Column_23 as string,",
				"          Column_24 as string,",
				"          Column_25 as string,",
				"          Column_26 as string,",
				"          Column_27 as string,",
				"          Column_28 as string",
				"     ),",
				"     partitionFileNames:['prep_job_mapping.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> OutputMappingToPrepFldr",
				"SortOnCorpTitle sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          Column_1 as string,",
				"          Column_2 as string,",
				"          Column_3 as string,",
				"          Column_4 as string,",
				"          Column_5 as string,",
				"          Column_6 as string,",
				"          Column_7 as string,",
				"          Column_8 as string,",
				"          Column_9 as string,",
				"          Column_10 as string,",
				"          Column_11 as string,",
				"          Column_12 as string,",
				"          Column_13 as string,",
				"          Column_14 as string,",
				"          Column_15 as string,",
				"          Column_16 as string,",
				"          Column_17 as string,",
				"          Column_18 as string,",
				"          Column_19 as string,",
				"          Column_20 as string,",
				"          Column_21 as string,",
				"          Column_22 as string,",
				"          Column_23 as string,",
				"          Column_24 as string,",
				"          Column_25 as string,",
				"          Column_26 as string,",
				"          Column_27 as string,",
				"          Column_28 as string",
				"     ),",
				"     partitionFileNames:['job_mapping.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> OutputMappingToWorkingFldr"
			]
		}
	}
}